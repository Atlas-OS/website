---
import { Picture as AstroPicture } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
  src: ImageMetadata;
  alt: string;
  width?: number;
  height?: number;
  formats?: ('avif' | 'webp' | 'png' | 'jpg')[];
  loading?: 'lazy' | 'eager';
  layout?: 'full-width' | 'constrained' | 'fixed';
  sizes?: string;
  class?: string;
  draggable?: boolean;
}

const {
  src,
  alt,
  width,
  height,
  formats = ['avif', 'webp'],
  loading = 'lazy',
  layout = 'constrained',
  sizes,
  class: className = '',
  draggable = true,
} = Astro.props;

const hasDimensions = width && height;
---

<AstroPicture
  src={src}
  alt={alt}
  width={width}
  height={height}
  formats={formats}
  loading={loading}
  layout={layout}
  sizes={sizes}
  class={className}
  draggable={draggable}
  {...hasDimensions && { style: `aspect-ratio: ${width} / ${height}` }}
/>
